---
interface Props {
  title: string;
  description: string;
  canonical?: string;
  image?: string;
  type?: 'website' | 'article' | 'profile';
  publishedDate?: string;
  modifiedDate?: string;
  author?: string;
  keywords?: string[];
  noindex?: boolean;
}

const {
  title,
  description,
  canonical = Astro.url.href,
  image = '/og-image.svg',
  type = 'website',
  publishedDate,
  modifiedDate,
  author = 'Audrey Tesson',
  keywords = ['Symfony', 'PHP', 'Développeur', 'Freelance', 'API', 'Full-Stack'],
  noindex = false,
} = Astro.props;

const siteUrl = 'https://audreytesson.dev';
const fullImageUrl = image.startsWith('http') ? image : `${siteUrl}${image}`;
const fullCanonical = canonical.startsWith('http') ? canonical : `${siteUrl}${canonical}`;

// Schema.org Person
const personSchema = {
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Audrey Tesson",
  "url": siteUrl,
  "jobTitle": "Développeuse Full-Stack Symfony & Tech Lead",
  "description": "Développeuse Full-Stack PHP/Symfony et Tech Lead spécialisée en architecture d'APIs, intégration IA et DevOps.",
  "email": "audreytesson.dev@proton.me",
  "knowsAbout": [
    "PHP",
    "Symfony",
    "API Platform",
    "Architecture logicielle",
    "DevOps",
    "Docker",
    "Intelligence Artificielle",
    "RabbitMQ",
    "MySQL",
    "PostgreSQL",
    "Redis"
  ],
  "sameAs": [
    "https://github.com/AudreyTesson",
    "https://www.linkedin.com/in/audrey-tesson-dev/"
  ]
};

// Schema.org WebSite
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Audrey Tesson - Portfolio",
  "url": siteUrl,
  "description": "Portfolio de Audrey Tesson, développeuse Full-Stack Symfony et Tech Lead freelance.",
  "author": {
    "@type": "Person",
    "name": "Audrey Tesson"
  }
};

// Schema.org pour les pages projets (Article)
const articleSchema = type === 'article' ? {
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": title,
  "description": description,
  "image": fullImageUrl,
  "author": {
    "@type": "Person",
    "name": author
  },
  "publisher": {
    "@type": "Person",
    "name": "Audrey Tesson"
  },
  "datePublished": publishedDate,
  "dateModified": modifiedDate || publishedDate,
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": fullCanonical
  }
} : null;
---

<!-- Primary Meta Tags -->
<meta name="title" content={title}>
<meta name="description" content={description}>
{keywords.length > 0 && <meta name="keywords" content={keywords.join(', ')}>}
<meta name="author" content={author}>
<meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow'}>
<link rel="canonical" href={fullCanonical}>

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type}>
<meta property="og:url" content={fullCanonical}>
<meta property="og:title" content={title}>
<meta property="og:description" content={description}>
<meta property="og:image" content={fullImageUrl}>
<meta property="og:image:alt" content={title}>
<meta property="og:site_name" content="Audrey Tesson - Portfolio">
<meta property="og:locale" content="fr_FR">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" content={fullCanonical}>
<meta name="twitter:title" content={title}>
<meta name="twitter:description" content={description}>
<meta name="twitter:image" content={fullImageUrl}>
<meta name="twitter:image:alt" content={title}>

<!-- Additional SEO -->
<meta name="theme-color" content="#6366f1">
<meta name="msapplication-TileColor" content="#6366f1">
<link rel="sitemap" href="/sitemap.xml">

<!-- Schema.org JSON-LD -->
<script type="application/ld+json" set:html={JSON.stringify(personSchema)} />
<script type="application/ld+json" set:html={JSON.stringify(websiteSchema)} />
{articleSchema && <script type="application/ld+json" set:html={JSON.stringify(articleSchema)} />}
